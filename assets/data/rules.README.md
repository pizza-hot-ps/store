```md
#   دليل قواعد الخصم – rules.json

هذا الملف يشرح القاعدة العامة لبنية ملف `rules.json`، ويُفسّر كل قاعدة خصم مفعّلة حاليًا.  
أي تعديل أو إضافة في `rules.json` يجب أن يُوثق هنا مباشرة بنفس التنسيق الرمزي.

---

## 🧩 القاعدة العامة لبنية كل قاعدة خصم

كل قاعدة داخل `rules.json` يجب أن تحتوي على الحقول التالية:

```json
{
  "name": "اسم القاعدة",
  "type": "percentage | fixed",
  "value": رقم الخصم (مثلاً 0.10 أو 15),
  "code": "كود الخصم أو null",
  "condition": "دالة شرطية (JavaScript)",
  "poster": "null أو رقم القاعدة الأصلية",
  "source": "auto | poster | manual",
  "active": true | false
}
```

### ✅ توضيح الحقول:
- `name`: اسم مرئي وواضح للقاعدة  
- `type`: نوع الخصم – نسبة مئوية (`percentage`) أو قيمة ثابتة (`fixed`)  
- `value`: قيمة الخصم – كنسبة (مثل `0.12`) أو رقم مباشر (مثل `9`)  
- `code`: كود الخصم إن وجد، أو `null` للخصومات التلقائية  
- `condition`: شرط التفعيل بصيغة JavaScript، يُقيّم داخل `DiscountEngine.js`  
- `poster`: رقم القاعدة الأصلية إن كانت هذه القاعدة مشتقة منها، أو `null`  
- `source`: مصدر القاعدة – تلقائي (`auto`)، منشور (`poster`)، يدوي (`manual`)  
- `active`: هل القاعدة مفعّلة أم لا

---

## ✅ القواعد الحالية في rules.json

### 1. خصم الطلب المسبق
- **النوع:** نسبة 12%  
- **الكود:** تلقائي  
- **الشرط:** `isTomorrow(orderDate)` ← يُطبق إذا كان تاريخ الطلب هو الغد  
- **الوصف الرمزي:** يُحفّز المستخدم على الحجز المسبق

---

### 2. خصم الاستلام من المحل
- **النوع:** نسبة 10%  
- **الكود:** تلقائي  
- **الشرط:** `channel === 'instore'` ← يُطبق إذا اختار المستخدم "الاستلام من المحل"  
- **الوصف الرمزي:** يُحفّز على تقليل التوصيل

---

### 3. عرض بيتزا دجاج XL
- **النوع:** خصم ثابت 9₪  
- **الكود:** `CHICKENXL`  
- **الشرط:** `cart.some(i => i.item === 'عرض بيتزا دجاج XL')`  
- **الوصف الرمزي:** عرض ترويجي مرتبط بمنتج معين

---

### 4. عرض الحجم العائلي
- **النوع:** خصم ثابت 19₪  
- **الكود:** `FAMILYSET`  
- **الشرط:** `cart.some(i => i.item === 'العرض العائلي XL')`  
- **الوصف الرمزي:** عرض خاص بالحجم العائلي

---

### 5. عرض أجنحة الدجاج
- **النوع:** خصم ثابت 7₪  
- **الكود:** `WINGSDEAL`  
- **الشرط:** `cart.some(i => i.item === 'عرض أجنحة الدجاج')`  
- **الوصف الرمزي:** عرض جانبي ترويجي

---

## ✨ قواعد مستقبلية (يُضاف هنا عند التحديث)

### 6. خصم الجمعة
- **النوع:** نسبة 10%  
- **الكود:** `FRIDAY10`  
- **الشرط:** `new Date(orderDate).getDay() === 5 && desiredHour >= 14 && desiredHour <= 21`  
- **الوصف الرمزي:** يُفعل تلقائيًا يوم الجمعة بين 2 ظهرًا و9 مساءً

---

### 7. خصم اليومي (باقي الأيام)
- **النوع:** نسبة 5%  
- **الكود:** `DAILY5`  
- **الشرط:** `new Date(orderDate).getDay() !== 5 && desiredHour >= 14 && desiredHour <= 21`  
- **الوصف الرمزي:** يُفعل تلقائيًا في باقي الأيام بنفس توقيت خصم الجمعة

---

## 📋 تعليمات التعديل

- عند إضافة قاعدة جديدة:
  - أضفها إلى `rules.json`  
  - ثم أضف نسخة منها هنا بنفس التنسيق الرمزي
- عند تعديل شرط أو قيمة:
  - حدّثها في `rules.json`  
  - ثم عدّل التوثيق هنا مباشرة

---

## ✅ آخر تحديث

> تم تحديث هذا الملف بتاريخ: 28 أغسطس 2025  
> بواسطة: م – قائد المنظومة الرمزية
```
